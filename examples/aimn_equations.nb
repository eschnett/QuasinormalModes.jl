(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23583,        682]
NotebookOptionsPosition[     21206,        629]
NotebookOutlinePosition[     21642,        645]
CellTagsIndexPosition[     21599,        642]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Deriving AIM equations from a master equation", "Title",
 CellChangeTimes->{{3.815345786759321*^9, 3.815345796889669*^9}, {
  3.81534591654677*^9, 
  3.815345918315138*^9}},ExpressionUUID->"e0898830-bfee-49fa-a00d-\
4b8bd98a3fa6"],

Cell[CellGroupData[{

Cell["The master equation", "Section",
 CellChangeTimes->{{3.815345925854529*^9, 
  3.815345928524495*^9}},ExpressionUUID->"b6bb2607-ea88-4d86-a83c-\
fbe648c586d1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "masterEq", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"masterEq", "=", 
  RowBox[{
   RowBox[{"r", 
    RowBox[{"(", 
     RowBox[{"r", "-", "1"}], ")"}], 
    RowBox[{
     RowBox[{"\[Psi]", "''"}], "[", "r", "]"}]}], "+", 
   RowBox[{
    RowBox[{"\[Psi]", "'"}], "[", "r", "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"l", 
       RowBox[{"(", 
        RowBox[{"l", "+", "1"}], ")"}]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["s", "2"], "-", "1"}], "r"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], 
        SuperscriptBox["r", "3"]}], 
       RowBox[{"r", "-", "1"}]]}], ")"}], 
    RowBox[{"\[Psi]", "[", "r", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.815345767551016*^9, 3.815345780309833*^9}, 
   3.815345940886256*^9, 3.815346052423834*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"a4110a62-5a68-4d29-8784-e7e632febc1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["s", "2"]}], "r"], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r", "3"], " ", 
        SuperscriptBox["\[Omega]", "2"]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}]]}], ")"}]}], " ", 
   RowBox[{"\[Psi]", "[", "r", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Psi]", "\[Prime]",
    MultilineFunction->None], "[", "r", "]"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "r", " ", 
   RowBox[{
    SuperscriptBox["\[Psi]", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "r", "]"}]}]}]], "Output",
 CellChangeTimes->{3.815346052696417*^9, 3.815346159146056*^9, 
  3.815346676920601*^9, 3.815346908154516*^9, 3.8153469409737587`*^9, 
  3.815347165201797*^9, 3.815347781133484*^9, 3.8153480588059187`*^9, 
  3.815348998943075*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"8ffd7cc6-12cb-48e2-9d26-290180924443"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Incorporating boundary conditions", "Section",
 CellChangeTimes->{{3.815345979209489*^9, 
  3.8153459835987597`*^9}},ExpressionUUID->"a83b2af9-0959-4dda-b663-\
8c05db75e3cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"\[Psi]", ",", "boudaryMasterEq"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]", "[", "r_", "]"}], ":=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", "1"}], ")"}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", "\[Omega]"}]], 
     SuperscriptBox["r", 
      RowBox[{"2", "*", "\[ImaginaryI]", "*", "\[Omega]"}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", 
       RowBox[{"(", 
        RowBox[{"r", "-", "1"}], ")"}]}]], 
     RowBox[{"f", "[", "r", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boudaryMasterEq", "=", 
   RowBox[{"FullSimplify", "[", 
    FractionBox["masterEq", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "\[Omega]"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r"}], ")"}], 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]"}]], " ", 
      SuperscriptBox["r", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Omega]"}]}]], " "}]], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[Psi]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.815345278113475*^9, 3.815345413805582*^9}, {
   3.815345474907585*^9, 3.815345623531659*^9}, {3.8153456638198833`*^9, 
   3.815345744853095*^9}, {3.815345988070775*^9, 3.815346076230772*^9}, {
   3.8153461073114347`*^9, 3.81534611663132*^9}, 3.815346155921974*^9, {
   3.815346224328504*^9, 3.8153462425578747`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"28de0ac7-074a-4068-98d6-ddc7b0f599fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["s", "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        RowBox[{"2", " ", "\[Omega]"}]}], ")"}], "2"], "-", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{"l", "+", 
        SuperscriptBox["l", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"f", "[", "r", "]"}]}], "+", 
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["r", "2"]}], ")"}], " ", "\[Omega]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["f", "\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "r", " ", 
      RowBox[{
       SuperscriptBox["f", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.815346242936204*^9, 3.81534667712604*^9, 
  3.815346908339143*^9, 3.8153469411660213`*^9, 3.815347165444294*^9, 
  3.8153477813237467`*^9, 3.815348058998561*^9, 3.8153489991713667`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"d1688949-eae2-44fd-aedc-bc12db67ee66"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Domain compactification", "Section",
 CellChangeTimes->{{3.815346037743595*^9, 3.815346038903144*^9}, {
  3.815346249524329*^9, 
  3.815346256393798*^9}},ExpressionUUID->"9618d026-e30c-4949-b52d-\
8d6e82a0fc3a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"xTor", ",", "rTox", ",", "dfdr", ",", "d2fdr2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xTor", "=", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"1", "-", 
     FractionBox["1", "r"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rTox", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"x", "\[Equal]", 
       RowBox[{"(", 
        RowBox[{"x", "/.", "xTor"}], ")"}]}], ",", "r"}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfdr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "'"}], "[", "r", "]"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "//.", "xTor"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "*", 
      RowBox[{
       RowBox[{"f", "'"}], "[", "x", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2fdr2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "''"}], "[", "r", "]"}], "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "//.", "xTor"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "1"}], "}"}]}], "]"}], "2"], 
        RowBox[{
         RowBox[{"f", "''"}], "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "//.", "xTor"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "2"}], "}"}]}], "]"}], "*", 
        RowBox[{
         RowBox[{"f", "'"}], "[", "x", "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "compactMasterEq", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compactMasterEq", "=", 
   RowBox[{"Together", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "1"}], ")"}], "boudaryMasterEq"}], "//.", 
      RowBox[{"{", 
       RowBox[{"d2fdr2", ",", "dfdr", ",", 
        RowBox[{
         RowBox[{"f", "[", "r", "]"}], "\[Rule]", 
         RowBox[{"f", "[", "x", "]"}]}], ",", "rTox"}], "}"}]}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"xTor", ",", "rTox", ",", "dfdr", ",", "d2fdr2"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.815345278113475*^9, 3.815345413805582*^9}, {
   3.815345474907585*^9, 3.815345623531659*^9}, {3.8153456638198833`*^9, 
   3.815345744853095*^9}, {3.815345988070775*^9, 3.8153460340174427`*^9}, {
   3.8153462762947817`*^9, 3.815346294718207*^9}, {3.8153463453521*^9, 
   3.815346348181411*^9}, 3.815346419316268*^9, {3.815346452594756*^9, 
   3.815346461761449*^9}, {3.815346493944487*^9, 3.815346588423675*^9}, {
   3.815346621228734*^9, 3.815346625228878*^9}, {3.8153469026665697`*^9, 
   3.815346933343607*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"54d11167-960a-487f-9e4f-494bf748a42c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x", "]"}], "+", 
  RowBox[{"l", " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["l", "2"], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["s", "2"], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "-", 
  RowBox[{"x", " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["s", "2"], " ", "x", " ", 
   RowBox[{"f", "[", "x", "]"}]}], "-", 
  RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Omega]", " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{"4", " ", "\[ImaginaryI]", " ", "x", " ", "\[Omega]", " ", 
   RowBox[{"f", "[", "x", "]"}]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{"4", " ", "x", " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["f", "\[Prime]",
    MultilineFunction->None], "[", "x", "]"}], "+", 
  RowBox[{"4", " ", "x", " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Omega]", " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{"8", " ", "\[ImaginaryI]", " ", "x", " ", "\[Omega]", " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"4", " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["x", "2"], " ", "\[Omega]", " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{"x", " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"], " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.815346625886475*^9, 3.815346677380536*^9, {3.815346908593795*^9, 
   3.815346941375958*^9}, 3.81534716568592*^9, 3.815347781567411*^9, 
   3.815348059232623*^9, 3.8153489993972273`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"d358e169-a627-455b-89d7-922e94c07a09"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Result", "Section",
 CellChangeTimes->{{3.8153462971820602`*^9, 3.815346298972105*^9}, {
  3.815346632787547*^9, 
  3.815346633597134*^9}},ExpressionUUID->"e17017a1-4c2f-4d8c-8f77-\
b691b75ab2bb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"finalEq", ",", "\[Lambda]0", ",", "S0"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"finalEq", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{"compactMasterEq", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "[", "r", "]"}], ",", 
      RowBox[{
       RowBox[{"f", "'"}], "[", "r", "]"}], ",", 
      RowBox[{
       RowBox[{"f", "''"}], "[", "r", "]"}]}], "}"}], ",", "FullSimplify"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]0", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
     "finalEq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     RowBox[{"-", 
      RowBox[{
      "finalEq", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]], 
    FractionBox[
     RowBox[{
      RowBox[{"f", "''"}], "[", "x", "]"}], 
     RowBox[{
      RowBox[{"f", "'"}], "[", "x", "]"}]]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"S0", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
     "finalEq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     RowBox[{"-", 
      RowBox[{
      "finalEq", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]], 
    FractionBox[
     RowBox[{
      RowBox[{"f", "''"}], "[", "x", "]"}], 
     RowBox[{"f", "[", "x", "]"}]]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.815346640050301*^9, 3.815346666769528*^9}, {
  3.815347750748279*^9, 3.815347946119643*^9}, {3.815347992811448*^9, 
  3.815347995488834*^9}, {3.815348994619735*^9, 3.815348996488428*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"b66d111a-b249-4794-a838-36ac4cd4d65d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"l", "+", 
     SuperscriptBox["l", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["s", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "\[Omega]"}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", 
      SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
   RowBox[{"f", "[", "x", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Omega]"}], "+", 
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{"4", "-", 
        RowBox[{"3", " ", "x"}], "+", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", "\[Omega]"}]}], 
       ")"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", "x", " ", 
   RowBox[{
    SuperscriptBox["f", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.815346661337063*^9, 3.8153466774087543`*^9}, 
   3.8153469086088877`*^9, 3.815346941404525*^9, 3.8153471657879887`*^9, {
   3.815347775141872*^9, 3.8153478047377653`*^9}, {3.815347846529209*^9, 
   3.815347934359479*^9}, {3.815347984921138*^9, 3.815347996266466*^9}, 
   3.8153480592671824`*^9, 3.8153489994139423`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"ddefc1e8-8015-47d1-b1ed-76ef14572585"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Omega]"}], "+", 
   RowBox[{"x", " ", 
    RowBox[{"(", 
     RowBox[{"4", "-", 
      RowBox[{"3", " ", "x"}], "+", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", "\[Omega]"}]}], 
     ")"}]}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", "x"}]]], "Output",
 CellChangeTimes->{{3.815346661337063*^9, 3.8153466774087543`*^9}, 
   3.8153469086088877`*^9, 3.815346941404525*^9, 3.8153471657879887`*^9, {
   3.815347775141872*^9, 3.8153478047377653`*^9}, {3.815347846529209*^9, 
   3.815347934359479*^9}, {3.815347984921138*^9, 3.815347996266466*^9}, 
   3.8153480592671824`*^9, 3.815348999428339*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"a5df37cd-cc5e-461f-a4a5-61832aecf2d7"],

Cell[BoxData[
 FractionBox[
  RowBox[{"l", "+", 
   SuperscriptBox["l", "2"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["s", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", 
   RowBox[{"4", " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "\[Omega]"}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", 
    SuperscriptBox["\[Omega]", "2"]}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", "x"}]]], "Output",
 CellChangeTimes->{{3.815346661337063*^9, 3.8153466774087543`*^9}, 
   3.8153469086088877`*^9, 3.815346941404525*^9, 3.8153471657879887`*^9, {
   3.815347775141872*^9, 3.8153478047377653`*^9}, {3.815347846529209*^9, 
   3.815347934359479*^9}, {3.815347984921138*^9, 3.815347996266466*^9}, 
   3.8153480592671824`*^9, 3.815348999442791*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"1e610f53-1c5b-42d1-838f-5a9e3f65a59b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Julia Converter", "Section",
 CellChangeTimes->{{3.815348217869542*^9, 3.8153482232692413`*^9}, {
  3.815348542101796*^9, 
  3.815348543331524*^9}},ExpressionUUID->"eaf5539d-d3e8-4d8b-ae22-\
90742c848490"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ToString", "[", "\[IndentingNewLine]", 
    RowBox[{"InputForm", "[", "\[IndentingNewLine]", 
     FractionBox[
      RowBox[{"l", "+", 
       SuperscriptBox["l", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["s", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}]}], "+", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "\[Omega]"}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "x"}], ")"}], " ", 
        SuperscriptBox["\[Omega]", "2"]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", "x"}]], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<I\>\"", "\[Rule]", "\"\<im\>\""}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.810497129179647*^9, 3.810497225240074*^9}, {
   3.81049726109971*^9, 3.81049727182903*^9}, 3.8104973177486563`*^9, {
   3.815348233490589*^9, 3.815348234422728*^9}, {3.815348265129499*^9, 
   3.815348281814268*^9}, 3.815349004763577*^9, 3.815349036843192*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"8a81b1b7-14ca-4964-a34a-b376ff92aef7"],

Cell[BoxData["\<\"(l + l^2 + (-1 + s^2)*(-1 + x) + (4*im)*(-1 + x)*\[Omega] + \
4*(-2 + x)*\[Omega]^2)/((-1 + x)^2*x)\"\>"], "Output",
 CellChangeTimes->{{3.8153482496913223`*^9, 3.81534828246061*^9}, {
   3.815348999464059*^9, 3.8153490060774508`*^9}, 3.815349038294923*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"7780f375-0fed-4bb7-95e3-b1fa56a53a2f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1368.7128712871288`, 727.8415841584159},
WindowMargins->{{0, Automatic}, {Automatic, 20.673267326732674`}},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7cf4c0c1-53cc-4a3d-94be-d18146f01677"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 236, 4, 106, "Title",ExpressionUUID->"e0898830-bfee-49fa-a00d-4b8bd98a3fa6"],
Cell[CellGroupData[{
Cell[841, 30, 164, 3, 72, "Section",ExpressionUUID->"b6bb2607-ea88-4d86-a83c-fbe648c586d1"],
Cell[CellGroupData[{
Cell[1030, 37, 976, 29, 72, "Input",ExpressionUUID->"a4110a62-5a68-4d29-8784-e7e632febc1d"],
Cell[2009, 68, 1171, 34, 54, "Output",ExpressionUUID->"8ffd7cc6-12cb-48e2-9d26-290180924443"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3229, 108, 180, 3, 72, "Section",ExpressionUUID->"a83b2af9-0959-4dda-b663-8c05db75e3cc"],
Cell[CellGroupData[{
Cell[3434, 115, 1980, 52, 174, "Input",ExpressionUUID->"28de0ac7-074a-4068-98d6-ddc7b0f599fc"],
Cell[5417, 169, 1458, 41, 36, "Output",ExpressionUUID->"d1688949-eae2-44fd-aedc-bc12db67ee66"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6924, 216, 217, 4, 72, "Section",ExpressionUUID->"9618d026-e30c-4949-b52d-8d6e82a0fc3a"],
Cell[CellGroupData[{
Cell[7166, 224, 3256, 94, 233, "Input",ExpressionUUID->"54d11167-960a-487f-9e4f-494bf748a42c"],
Cell[10425, 320, 2572, 69, 54, "Output",ExpressionUUID->"d358e169-a627-455b-89d7-922e94c07a09"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13046, 395, 202, 4, 72, "Section",ExpressionUUID->"e17017a1-4c2f-4d8c-8f77-b691b75ab2bb"],
Cell[CellGroupData[{
Cell[13273, 403, 1668, 47, 134, "Input",ExpressionUUID->"b66d111a-b249-4794-a838-36ac4cd4d65d"],
Cell[14944, 452, 1912, 54, 36, "Output",ExpressionUUID->"ddefc1e8-8015-47d1-b1ed-76ef14572585"],
Cell[16859, 508, 959, 24, 51, "Output",ExpressionUUID->"a5df37cd-cc5e-461f-a4a5-61832aecf2d7"],
Cell[17821, 534, 1140, 31, 55, "Output",ExpressionUUID->"1e610f53-1c5b-42d1-838f-5a9e3f65a59b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19010, 571, 211, 4, 72, "Section",ExpressionUUID->"eaf5539d-d3e8-4d8b-ae22-90742c848490"],
Cell[CellGroupData[{
Cell[19246, 579, 1563, 39, 239, "Input",ExpressionUUID->"8a81b1b7-14ca-4964-a34a-b376ff92aef7"],
Cell[20812, 620, 354, 4, 33, "Output",ExpressionUUID->"7780f375-0fed-4bb7-95e3-b1fa56a53a2f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

